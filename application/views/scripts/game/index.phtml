<script type="text/javascript">
    <?php $this->headScript()->captureStart() ?>
    var fields = <?php echo Zend_Json::encode($this->fields); ?>;
    var ruins = <?php echo Zend_Json::encode($this->ruins); ?>;
    var units = <?php echo Zend_Json::encode($this->units); ?>;
    var towers = <?php echo Zend_Json::encode($this->towers); ?>;
    var artefacts = <?php echo Zend_Json::encode($this->artefacts); ?>;
    var players = <?php echo Zend_Json::encode($this->players); ?>;
    var castles = <?php echo Zend_Json::encode($this->castlesSchema); ?>;
    Image1= new Image(27,32);
    Image1.src = '../img/game/cursor_attack.png';
    Image2= new Image(14,46);
    Image2.src = '../img/game/cursor_castle.png';
    Image3= new Image(25,26);
    Image3.src = '../img/game/cursor_select.png';
    Image4= new Image(20,20);
    Image4.src = '../img/game/footsteps_e.png';
    Image5= new Image(20,20);
    Image5.src = '../img/game/footsteps_n.png';
    Image6= new Image(20,20);
    Image6.src = '../img/game/footsteps_s.png';
    Image7= new Image(20,20);
    Image7.src = '../img/game/footsteps_w.png';
    Image8= new Image(20,20);
    Image8.src = '../img/game/footsteps_ne.png';
    Image9= new Image(20,20);
    Image9.src = '../img/game/footsteps_nw.png';
    Image10= new Image(20,20);
    Image10.src = '../img/game/footsteps_se.png';
    Image11= new Image(20,20);
    Image11.src = '../img/game/footsteps_sw.png';
    Image12= new Image(33,18);
    Image12.src = '../img/game/cursor_arrow_e.png';
    Image13= new Image(18,34);
    Image13.src = '../img/game/cursor_arrow_n.png';
    Image14= new Image(18,34);
    Image14.src = '../img/game/cursor_arrow_s.png';
    Image15= new Image(33,18);
    Image15.src = '../img/game/cursor_arrow_w.png';
    Image16= new Image(28,28);
    Image16.src = '../img/game/cursor_arrow_ne.png';
    Image17= new Image(28,28);
    Image17.src = '../img/game/cursor_arrow_nw.png';
    Image18= new Image(28,28);
    Image18.src = '../img/game/cursor_arrow_se.png';
    Image19= new Image(28,28);
    Image19.src = '../img/game/cursor_arrow_sw.png';
    my.color = '<?php echo $this->color ?>';
    my.turn = <?php echo $this->myTurn ?>;
    my.game = <?php echo $this->myGame ?>;
    turn.color = '<?php echo $this->turn['color'] ?>';
    turn.nr = '<?php echo $this->turn['nr'] ?>';
    var channel = 'ch<?php echo $this->game['gameId'] ?>';
    var lAccessKey = '<?php echo $this->game['lAccessKey'] ?>';
    var lSecretKey = '<?php echo $this->game['lSecretKey'] ?>';
    var urlMove = '<?php echo $this->url(array('controller' => 'move', 'action' => 'go', 'armyId' => null, 'x' => null, 'y' => null)) ?>';
    var urlNextTurn = '<?php echo $this->url(array('controller' => 'turn', 'action' => 'next')) ?>';
    var urlGetTurn = '<?php echo $this->url(array('controller' => 'turn', 'action' => 'get')) ?>';
    var urlStartMyTurn = '<?php echo $this->url(array('controller' => 'turn', 'action' => 'start')) ?>';
    var urlFightEnemyCastle = '<?php echo $this->url(array('controller' => 'fight', 'action' => 'ecastle')) ?>';
    var urlFightNeutralCastle = '<?php echo $this->url(array('controller' => 'fight', 'action' => 'ncastle')) ?>';
    var urlFightArmy = '<?php echo $this->url(array('controller' => 'fight', 'action' => 'army')) ?>';
    var urlAddArmy = '<?php echo $this->url(array('controller' => 'gameajax', 'action' => 'addarmy')) ?>';
    var urlGetPlayerArmies = '<?php echo $this->url(array('controller' => 'gameajax', 'action' => 'armies')) ?>';
    var urlJoinArmy = '<?php echo $this->url(array('controller' => 'gameajax', 'action' => 'join')) ?>';
    var urlSplitArmy = '<?php echo $this->url(array('controller' => 'gameajax', 'action' => 'split')) ?>';
    var urlDisbandArmy = '<?php echo $this->url(array('controller' => 'gameajax', 'action' => 'disband')) ?>';
    var urlHeroResurrection = '<?php echo $this->url(array('controller' => 'gameajax', 'action' => 'resurrection')) ?>';
    var urlSearchRuins = '<?php echo $this->url(array('controller' => 'ruin', 'action' => 'search')) ?>';
    var urlGetRuins = '<?php echo $this->url(array('controller' => 'ruin', 'action' => 'get')) ?>';
    var urlSetProduction = '<?php echo $this->url(array('controller' => 'production', 'action' => 'set')) ?>';
    var urlCastleRaze = '<?php echo $this->url(array('controller' => 'castle', 'action' => 'raze')) ?>';
    var urlCastleBuild = '<?php echo $this->url(array('controller' => 'castle', 'action' => 'build')) ?>';
    var urlCastleGet = '<?php echo $this->url(array('controller' => 'castle', 'action' => 'get')) ?>';
    var urlTowerAdd = '<?php echo $this->url(array('controller' => 'tower', 'action' => 'add')) ?>';
    var urlTowerGet = '<?php echo $this->url(array('controller' => 'tower', 'action' => 'get')) ?>';
    var urlComputer = '<?php echo $this->url(array('controller' => 'computer', 'action' => null)) ?>';
    <?php $this->headScript()->captureEnd() ?>
    var zoomPad = $(".zoomPad");
    var board = $("#board")
    .mousedown(function(event) {
        if(lock) {
            return null;
        }

        switch (event.which) {
            case 1:
                if(selectedArmy) {
                    moveA(cursorPosition(event.pageX, event.pageY, 1));
                }
                break;
            case 2:
                alert('Middle mouse button pressed');
                break;
            case 3:
                unselectArmy();
                break;
            default:
                alert('You have a strange mouse');
        }
    })
    .mousemove(function(e) {
        if(lock) {
            return null;
        }
        cursorPosition(e.pageX, e.pageY);
    })
    .mouseleave(function(){$('.path').remove()});
    $('#send').click(function(){wsChat()});
    $('#msg').keypress(function(e){if(e.which == 13)wsChat()});
    $('.'+my.color+' .color').append('You');
    $('.'+turn.color+' .turn').html('Turn >');
    $('#turnNumber').html(turn.nr);
    $('#nextTurn').click(function(){nextTurnM()});
    $('#nextArmy').click(function(){findNextArmy()});
    $('#skipArmy').click(function(){skipArmy()});
    $('#quitArmy').click(function(){quitArmy()});
    $('#splitArmy').click(function(){if(selectedArmy){splitArmyM()}});
    $('#armyStatus').click(function(){if(selectedArmy){armyStatusM()}});
    $('#disbandArmy').click(function(){if(selectedArmy){disbandArmyM()}});
    $('#searchRuins').click(function(){searchRuinsA()});
    $('#test').click(function(){test()});
    $('#nextTurn').addClass('buttonOff');
    $('#nextArmy').addClass('buttonOff');
    $('#skipArmy').addClass('buttonOff');
    $('#quitArmy').addClass('buttonOff');
    $('#splitArmy').addClass('buttonOff');
    $('#disbandArmy').addClass('buttonOff');
    $('#searchRuins').addClass('buttonOff');
    goldUpdate(<?php echo $this->gold ?>);

</script>
